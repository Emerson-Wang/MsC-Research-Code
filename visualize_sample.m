k = 10;
region = cell2mat(tissueRegions(1));
[tissue_row, tissue_col] = find(region);
tissue_xyz = tissue_region(cell2mat(align_xyz(1)), region);
current_xyz = squeeze(tissue_xyz);
[W, ~] = nnmf(current_xyz.', k);
score = [];
for jx = 1:size(current_xyz,1)
    sc = current_xyz(jx,:)*W;
    score = [score;sc];
end
new_xyz = score;
norm_xyz = vecnorm(new_xyz,2,2);
[norm_xyz, ind] = sort(norm_xyz,'descend');
current_xyz = current_xyz(ind,:);
tissue_col = tissue_col(ind);
tissue_row = tissue_row(ind);
sample_n = floor(size(new_xyz,1)/2.5);
tissue_row = tissue_row(1:sample_n);
tissue_col = tissue_col(1:sample_n);
[m, n] = size(region);
new_region = zeros(m,n,3);
R = zeros(m,n,1);
G = zeros(m,n,1);
B = zeros(m,n,1);
R(region) = 255;
G(region) = 255;
B(region) = 255;
ind = sub2ind(size(region),tissue_row,tissue_col);
G(ind) = 0;
B(ind) = 0;
new_region(:,:,1) = R;
new_region(:,:,2) = G; 
new_region(:,:,3) = B; 
tissue_xyz = current_xyz(1:sample_n,:);
